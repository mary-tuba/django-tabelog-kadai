{% extends 'base.html' %}

{% block title %}登録店舗一覧 - NAGOYAMESHI{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><i class="fas fa-store"></i> 登録した店舗一覧</h1>
        <a href="{% url 'restaurants:create' %}" class="btn btn-primary">
            <i class="fas fa-plus"></i> 新規店舗登録
        </a>
    </div>
    
    <!-- プレミアム会員限定の案内 -->
    <div class="alert alert-info mb-4">
        <h6><i class="fas fa-crown text-warning"></i> プレミアム会員特典</h6>
        <p class="mb-0">プレミアム会員として、店舗登録のリクエストができます。必ず登録されるとは限りませんが、レビューをしたい、予約したいと考えている方はぜひ依頼をお出しください！</p>
    </div>
    
    {% if restaurants %}
        <div class="row">
            {% for restaurant in restaurants %}
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h5 class="card-title">{{ restaurant.name }}</h5>
                                {% if restaurant.is_active %}
                                    <span class="badge bg-success">公開中</span>
                                {% else %}
                                    <span class="badge bg-warning">承認待ち</span>
                                {% endif %}
                            </div>
                            
                            <p class="card-text text-muted small">
                                <i class="fas fa-tag"></i> {{ restaurant.category.name }}
                            </p>
                            
                            <p class="card-text">{{ restaurant.description|truncatechars:100 }}</p>
                            
                            <div class="small text-muted mb-3">
                                <div><i class="fas fa-map-marker-alt"></i> {{ restaurant.address|truncatechars:50 }}</div>
                                {% if restaurant.phone_number %}
                                    <div><i class="fas fa-phone"></i> {{ restaurant.phone_number }}</div>
                                {% endif %}
                                {% if restaurant.opening_hours %}
                                    <div><i class="fas fa-clock"></i> {{ restaurant.opening_hours }}</div>
                                {% endif %}
                                {% if restaurant.budget_min and restaurant.budget_max %}
                                    <div><i class="fas fa-yen-sign"></i> ¥{{ restaurant.budget_min|floatformat:0 }} - ¥{{ restaurant.budget_max|floatformat:0 }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-muted">
                                    登録日: {{ restaurant.created_at|date:"Y/m/d" }}
                                </small>
                                <div>
                                    {% if restaurant.is_active %}
                                        <a href="{% url 'restaurants:detail' restaurant.id %}" 
                                           class="btn btn-outline-primary btn-sm">
                                            <i class="fas fa-eye"></i> 表示
                                        </a>
                                    {% else %}
                                        <button class="btn btn-outline-secondary btn-sm" disabled>
                                            <i class="fas fa-clock"></i> 承認待ち
                                        </button>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <!-- 店舗がない場合 -->
        <div class="text-center py-5">
            <i class="fas fa-store fa-4x text-muted mb-4"></i>
            <h4 class="text-muted">登録された店舗がありません</h4>
            <p class="text-muted mb-4">
                初めての店舗を登録して、NAGOYAMESHIに掲載してみませんか？<br>
                登録された店舗は管理者承認後にサイトに公開されます。
            </p>
            <a href="{% url 'restaurants:create' %}" class="btn btn-primary btn-lg">
                <i class="fas fa-plus"></i> 初めての店舗を登録
            </a>
        </div>
    {% endif %}
    
    <!-- ヘルプ情報 -->
    <div class="row mt-5">
        <div class="col-md-6">
            <div class="card bg-light">
                <div class="card-header">
                    <h6><i class="fas fa-question-circle"></i> 承認プロセスについて</h6>
                </div>
                <div class="card-body">
                    <ul class="mb-0 small">
                        <li>登録申請後、2週間程度で審査結果をお知らせします</li>
                        <li>審査中は「承認待ち」ステータスで表示されます</li>
                        <li>承認されると自動的にサイトに公開されます</li>
                        <li>審査に関するお問い合わせは管理者までご連絡ください</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card bg-light">
                <div class="card-header">
                    <h6><i class="fas fa-lightbulb"></i> 店舗登録のコツ</h6>
                </div>
                <div class="card-body">
                    <ul class="mb-0 small">
                        <li>詳細な店舗説明を記載すると承認されやすくなります</li>
                        <li>正確な営業時間・定休日の記載をお願いします</li>
                        <li>適切なカテゴリの選択が重要です</li>
                        <li>連絡先情報は可能な限り入力してください</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}